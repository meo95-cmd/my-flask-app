    <script>
    const form = document.getElementById("taskForm");
    const editForm = document.getElementById("editForm");
    const taskTableBody = document.querySelector("#taskTable tbody");
    let currentEditNo;

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const task = {
        No: formData.get("no"),
        date: formData.get("date"),
        device: formData.get("device"),
        problem: formData.get("problem"),
        cause: formData.get("cause"),
        solution: formData.get("solution"),
        person: formData.get("person"),
        priority: formData.get("priority"),
        comment: formData.get("comment")
      };
      await fetch("/add", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(task)
      });
      form.reset();
      loadTasks();
    });

    taskTableBody.addEventListener("click", (e) => {
      const row = e.target.closest("tr");
      const taskNo = row.children[0].textContent;

      if (e.target.classList.contains("deleteBtn")) {
        fetch(`/delete/${taskNo}`, { method: "DELETE" }).then(loadTasks);
      }

      if (e.target.classList.contains("editBtn")) {
        currentEditNo = taskNo;
        document.getElementById("editNo").value = taskNo;
        document.getElementById("editDate").value = row.children[1].textContent;
        document.getElementById("editDevice").value = row.children[2].textContent;
        document.getElementById("editProblem").value = row.children[3].textContent;
        document.getElementById("editCause").value = row.children[4].textContent;
        document.getElementById("editSolution").value = row.children[5].textContent;
        document.getElementById("editPerson").value = row.children[6].textContent;
        document.getElementById("editPriority").value = row.children[7].textContent;
        document.getElementById("editComment").value = row.children[8].textContent;
        const modal = new bootstrap.Modal(document.getElementById("editModal"));
        modal.show();
      }
    });

    editForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const editedTask = {
        date: document.getElementById("editDate").value,
        device: document.getElementById("editDevice").value,
        problem: document.getElementById("editProblem").value,
        cause: document.getElementById("editCause").value,
        solution: document.getElementById("editSolution").value,
        person: document.getElementById("editPerson").value,
        priority: document.getElementById("editPriority").value,
        comment: document.getElementById("editComment").value
      };
      await fetch(`/edit/${currentEditNo}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(editedTask)
      });
      const modal = bootstrap.Modal.getInstance(document.getElementById("editModal"));
      modal.hide();
      loadTasks();
    });

    async function loadTasks() {
      const res = await fetch("/tasks");
      const tasks = await res.json();
      taskTableBody.innerHTML = "";
      tasks.forEach(task => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${task.No}</td>
          <td>${task.date}</td>
          <td>${task.device}</td>
          <td>${task.problem}</td>
          <td>${task.cause}</td>
          <td>${task.solution}</td>
          <td>${task.person}</td>
          <td>${task.priority}</td>
          <td>${task.comment}</td>
          <td>
            <button class="btn btn-warning btn-sm editBtn">✏️</button>
            <button class="btn btn-danger btn-sm deleteBtn">🗑️</button>
          </td>
        `;
        taskTableBody.appendChild(row);
      });
    }

    loadTasks();
    </script>
  </body>
</html>
